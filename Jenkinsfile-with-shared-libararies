@Library('shared_librareis@main') _
pipeline {
    agent {
        docker {
            image 'dharimigariarjun/devops-tools-image:20250913-124024'
            args '-v /var/run/docker.sock:/var/run/docker.sock'
        }
    }
 stages {
  stage ('Checking version') {
   steps {
     script {
       sh "python --version"
       sh "docker --version"
       sh "git --version"
       sh "trivy --version"
    }
  }
 }
stage ('Install dependecies') {
   steps {
    script {
     python_dependencies()
    }
   }
  }
  stage ('test') {
   steps {
    script {
      pytest() 
   }
  }
}
stage ('sonar analysis') { 
  stpes {
   script {
     sonar_analysis(
       toolName : "sonar-scanner",
       sonarEnv : "sonar",
       projectKey : "web-app-mysql-k8s"
    )
  }
}
}
}
}
     

