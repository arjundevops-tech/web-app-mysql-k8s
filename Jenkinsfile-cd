pipeline {
  agent any {
    stages {
      stage ('Verify deployment details') {
        steps {
          script {
          }
        }
      }
      stage ('Web app deployment') {
        steps {
          script {
            withCredentials([[$class: 'AmazonWebServicesCredentialsBinding', credentialsId: 'eks-credentials']]) {
            sh """
                export AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID
                export AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY
                export AWS_DEFAULT_REGION=us-east-2
                aws eks update-kubeconfig --region us-east-2 --name staging-demo
                cd k8s/web
                kubeclt apply -f web-namespace.yml
                kubeclt apply -f web-namespace.yml
                kubeclt apply web-deployment.yml
              """
          }
        }
      }
      stage ('db deployment') {
        steps {
          script {
            println("empty db deployment")
          }
        }
      }
    }
  }
        
